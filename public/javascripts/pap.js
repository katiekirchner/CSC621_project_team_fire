!function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){i(1)},function(e,t,i){"use strict";var a=a||{},n=[],s=s||[],o=[];a.Container=a.Container||function(e){this.containerHtml=e,this.containerIndex=null,this.toolbarHtml=null,this.viewerHtml=null,this.displayHtml=null,this.titlebarHtml=null,this.sliderControlHtml=null,this.viewer=null,this.display=null,this.toolbar=null,this.preferences=null,this.params=[],this.loadingImageIndex=0,this.loadingSurfaceIndex=0,this.nestedViewer=!1,this.collapsable=!1,this.orthogonal=!0,this.orthogonalTall=!1,this.orthogonalDynamic=!1,this.kioskMode=!1,this.noNewFiles=!1,this.showControls=!0,this.showControlBar=!1,this.showImageButtons=!0,this.fullScreenPadding=!0,this.combineParametric=!1,this.dropTimeout=null,this.showRuler=!1,this.syncOverlaySeries=!0,this.surfaceParams={},this.contextManager=null,this.allowScroll=!0,this.loadingComplete=null,this.resetComponents()},a.Container.LICENSE_TEXT="<p>THIS PRODUCT IS NOT FOR CLINICAL USE.<br /><br />This software is available for use, as is, free of charge.  The software and data derived from this software may not be used for clinical purposes.<br /><br />The authors of this software make no representations or warranties about the suitability of the software, either express or implied, including but not limited to the implied warranties of merchantability, fitness for a particular purpose, non-infringement, or conformance to a specification or standard. The authors of this software shall not be liable for any damages suffered by licensee as a result of using or modifying this software or its derivatives.<br /><br />By using this software, you agree to be bounded by the terms of this license.  If you do not agree to the terms of this license, do not use this software.</p>",a.Container.KEYBOARD_REF_TEXT="<span style='color:#B5CBD3'>[Spacebar]</span> Cycle the main slice view in a clockwise rotation.<br /><br /><span style='color:#B5CBD3'>[Page Up]</span> or <span style='color:#B5CBD3'>[']</span> Increment the axial slice.<br /><br /><span style='color:#B5CBD3'>[Page Down]</span> or <span style='color:#B5CBD3'>[/]</span> Decrement the axial slice.<br /><br /><span style='color:#B5CBD3'>[Arrow Up]</span> and <span style='color:#B5CBD3'>[Arrow Down]</span> Increment/decrement the coronal slice.<br /><br /><span style='color:#B5CBD3'>[Arrow Right]</span> and <span style='color:#B5CBD3'>[Arrow Left]</span> Increment/decrement the sagittal slice.<br /><br /><span style='color:#B5CBD3'>[g]</span> and <span style='color:#B5CBD3'>[v]</span> Increment/decrement main slice.<br /><br /><span style='color:#B5CBD3'>[<]</span> or <span style='color:#B5CBD3'>[,]</span> Decrement the series point.<br /><br /><span style='color:#B5CBD3'>[>]</span> or <span style='color:#B5CBD3'>[.]</span> Increment the series point.<br /><br /><span style='color:#B5CBD3'>[o]</span> Navigate viewer to the image origin.<br /><br /><span style='color:#B5CBD3'>[c]</span> Navigate viewer to the center of the image.<br /><br /><span style='color:#B5CBD3'>[a]</span> Toggle main crosshairs on/off.",a.Container.MOUSE_REF_TEXT="<span style='color:#B5CBD3'>(Left-click and drag)</span> Change current coordinate.<br /><br /><span style='color:#B5CBD3'>[Alt](Left-click and drag)</span> Zoom in and out.<br /><br /><span style='color:#B5CBD3'>[Alt](Double left-click)</span> Reset zoom.<br /><br /><span style='color:#B5CBD3'>[Alt][Shift](Left-click and drag)</span> Pan zoomed image.<br /><br /><span style='color:#B5CBD3'>(Right-click and drag)</span> Window level controls.<br /><br /><span style='color:#B5CBD3'>(Scroll wheel)</span> See Preferences.<br /><br />",a.Container.DICOM_SUPPORT=!0,a.Container.syncViewers=!1,a.Container.syncViewersWorld=!1,a.Container.allowPropagation=!1,a.Container.papayaLastHoveredViewer=null,a.Container.ignorePatterns=[/^[.]/],a.Container.atlas=null,a.Container.atlasWorldSpace=!0,a.Container.restartViewer=function(e,t,i,a,s){n[e].viewer.restart(t,i,a,s)},a.Container.resetViewer=function(e,t){t||((t=n[e].params).loadedImages&&(t.images=t.loadedImages),t.loadedEncodedImages&&(t.encodedImages=t.loadedEncodedImages),t.loadedBinaryImages&&(t.binaryImages=t.loadedBinaryImages),t.loadedSurfaces&&(t.surfaces=t.loadedSurfaces),t.loadedEncodedSurfaces&&(t.encodedSurfaces=t.loadedEncodedSurfaces),t.loadedFiles&&(t.files=t.loadedFiles)),n[e].viewer.resetViewer(),n[e].toolbar.updateImageButtons(),n[e].reset(),n[e].params=t,n[e].readGlobalParams(),n[e].rebuildContainer(t,e),n[e].viewer.processParams(t)},a.Container.removeImage=function(e,t){t<1&&console.log("Cannot remove the base image.  Try papaya.Container.resetViewer() instead."),n[e].viewer.removeOverlay(t)},a.Container.hideImage=function(e,t){n[e].viewer.screenVolumes[t].hidden=!0,n[e].viewer.drawViewer(!0,!1)},a.Container.showImage=function(e,t){n[e].viewer.screenVolumes[t].hidden=!1,n[e].viewer.drawViewer(!0,!1)},a.Container.addImage=function(e,t,i){var a;i&&(n[e].params=$.extend({},n[e].params,i)),t instanceof Array?a=t:(a=[])[0]=t,n[e].params.images?n[e].viewer.loadImage(a,!0,!1,!1):n[e].params.binaryImages?n[e].viewer.loadImage(a,!1,!1,!0):n[e].params.encodedImages&&n[e].viewer.loadImage(a,!1,!0,!1)},a.Container.findParameters=function(e){var t,i,n=null;return(i=e.data("params"))||(t=e.find("."+PAPAYA_VIEWER_CSS))&&(i=t.data("params")),i&&("object"==typeof i?n=i:window[i]&&(n=window[i])),n&&a.utilities.UrlUtils.getQueryParams(n),n},a.Container.fillContainerHTML=function(e,t,i,a){var s,o,r,l;return t?(s=e.find("#"+PAPAYA_DEFAULT_TOOLBAR_ID),o=e.find("#"+PAPAYA_DEFAULT_VIEWER_ID),r=e.find("#"+PAPAYA_DEFAULT_DISPLAY_ID),s?s.addClass(PAPAYA_TOOLBAR_CSS):e.prepend("<div class='"+PAPAYA_TOOLBAR_CSS+"' id='"+PAPAYA_DEFAULT_TOOLBAR_ID+"'></div>"),o?o.addClass(PAPAYA_VIEWER_CSS):$("<div class='"+PAPAYA_VIEWER_CSS+"' id='"+PAPAYA_DEFAULT_VIEWER_ID+"'></div>").insertAfter($("#"+PAPAYA_DEFAULT_TOOLBAR_ID)),r?r.addClass(PAPAYA_DISPLAY_CSS):$("<div class='"+PAPAYA_DISPLAY_CSS+"' id='"+PAPAYA_DEFAULT_DISPLAY_ID+"'></div>").insertAfter($("#"+PAPAYA_DEFAULT_VIEWER_ID)),console.log("This method of adding a Papaya container is deprecated.  Try simply <div class='papaya' data-params='params'></div> instead...")):(l=void 0!==a?a:n.length,e.attr("id",PAPAYA_DEFAULT_CONTAINER_ID+l),i&&void 0!==i.kioskMode&&i.kioskMode||e.append("<div id='"+(PAPAYA_DEFAULT_TOOLBAR_ID+l)+"' class='"+PAPAYA_TOOLBAR_CSS+"'></div>"),e.append("<div id='"+(PAPAYA_DEFAULT_VIEWER_ID+l)+"' class='"+PAPAYA_VIEWER_CSS+"'></div>"),e.append("<div id='"+(PAPAYA_DEFAULT_DISPLAY_ID+l)+"' class='"+PAPAYA_DISPLAY_CSS+"'></div>"),i&&i.showControlBar&&(void 0===i.showControls||i.showControls)?(e.append("<div id='"+PAPAYA_KIOSK_CONTROLS_CSS+l+"' class='"+PAPAYA_KIOSK_CONTROLS_CSS+"'><div id='"+(PAPAYA_DEFAULT_SLIDER_ID+l)+"main' class='"+PAPAYA_SLIDER_CSS+" "+PAPAYA_CONTROL_MAIN_SLIDER+"'><span class='"+PAPAYA_CONTROL_BAR_LABELS_CSS+"'>Slice: </span> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>+</button> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>-</button> </div><div id='"+(PAPAYA_DEFAULT_SLIDER_ID+l)+"axial' class='"+PAPAYA_SLIDER_CSS+" "+PAPAYA_CONTROL_DIRECTION_SLIDER+"'><span class='"+PAPAYA_CONTROL_BAR_LABELS_CSS+"'>Axial: </span> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>+</button> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>-</button> </div><div id='"+(PAPAYA_DEFAULT_SLIDER_ID+l)+"coronal' class='"+PAPAYA_SLIDER_CSS+" "+PAPAYA_CONTROL_DIRECTION_SLIDER+"'><span class='"+PAPAYA_CONTROL_BAR_LABELS_CSS+"'>Coronal: </span> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>+</button> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>-</button> </div><div id='"+(PAPAYA_DEFAULT_SLIDER_ID+l)+"sagittal' class='"+PAPAYA_SLIDER_CSS+" "+PAPAYA_CONTROL_DIRECTION_SLIDER+"'><span class='"+PAPAYA_CONTROL_BAR_LABELS_CSS+"'>Sagittal: </span> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>+</button> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>-</button> </div><div id='"+(PAPAYA_DEFAULT_SLIDER_ID+l)+"series' class='"+PAPAYA_SLIDER_CSS+" "+PAPAYA_CONTROL_DIRECTION_SLIDER+"'><span class='"+PAPAYA_CONTROL_BAR_LABELS_CSS+"'>Series: </span> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>&lt;</button> <button type='button' class='"+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS+"'>&gt;</button> </div>&nbsp;&nbsp;&nbsp;<button type='button' "+(i.kioskMode&&(void 0===i.showImageButtons||i.showImageButtons)?"":"style='float:right;margin-left:5px;' ")+"class='"+PAPAYA_CONTROL_SWAP_BUTTON_CSS+"'>Swap View</button> <button type='button' "+(i.kioskMode&&(void 0===i.showImageButtons||i.showImageButtons)?"":"style='float:right;margin-left:5px;' ")+"class='"+PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS+"'>Go To Center</button> <button type='button' "+(i.kioskMode&&(void 0===i.showImageButtons||i.showImageButtons)?"":"style='float:right;margin-left:5px;' ")+"class='"+PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS+"'>Go To Origin</button> </div>"),$("."+PAPAYA_CONTROL_INCREMENT_BUTTON_CSS).prop("disabled",!0),$("."+PAPAYA_CONTROL_SWAP_BUTTON_CSS).prop("disabled",!0),$("."+PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).prop("disabled",!0),$("."+PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).prop("disabled",!0)):i&&(void 0===i.showControls||i.showControls)&&(e.append("<button type='button' id='"+(PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS+l)+"' class='"+PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS+"'>+</button> "),e.append("<button type='button' id='"+(PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS+l)+"' class='"+PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS+"'>-</button> "),e.append("<button type='button' id='"+(PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS+l)+"' class='"+PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS+"'>Swap View</button> "),e.append("<button type='button' id='"+(PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS+l)+"' class='"+PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS+"'>Go To Center</button> "),e.append("<button type='button' id='"+(PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS+l)+"' class='"+PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS+"'>Go To Origin</button> "),$("#"+PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS+l).css({display:"none"}),$("#"+PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS+l).css({display:"none"}),$("#"+PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS+l).css({display:"none"}),$("#"+PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS+l).css({display:"none"}),$("#"+PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS+l).css({display:"none"}))),o},a.Container.buildContainer=function(e,t,i){var s,o,r,l,d,h=null;o=a.utilities.PlatformUtils.checkForBrowserCompatibility(),r=e.find("."+PAPAYA_VIEWER_CSS),null!==o?(a.Container.removeCheckForJSClasses(e,r),e.addClass(PAPAYA_UTILS_UNSUPPORTED_CSS),r.addClass(PAPAYA_UTILS_UNSUPPORTED_MESSAGE_CSS),r.html(o)):(d=void 0!==i?i:n.length,(s=new a.Container(e)).containerIndex=d,s.preferences=new a.viewer.Preferences,a.Container.removeCheckForJSClasses(e,r),t&&(s.params=$.extend(s.params,t)),s.nestedViewer="BODY"!==e.parent()[0].tagName.toUpperCase(),s.readGlobalParams(),s.isDesktopMode()&&s.preferences.readPreferences(),s.buildViewer(s.params),s.buildDisplay(),s.showControlBar&&s.buildSliderControl(),s.buildToolbar(),s.setUpDnD(),(l=r.data("load-url"))?((h=l)instanceof Array||((h=[])[0]=l),s.viewer.loadImage(h,!0,!1,!1)):s.params.images?((h=s.params.images[0])instanceof Array||((h=[])[0]=s.params.images[0]),s.viewer.loadImage(h,!0,!1,!1)):s.params.encodedImages?((h=s.params.encodedImages[0])instanceof Array||((h=[])[0]=s.params.encodedImages[0]),s.viewer.loadImage(h,!1,!0,!1)):s.params.binaryImages?(h=s.params.binaryImages[0],s.viewer.loadImage(h,!1,!1,!0)):s.params.files?((h=s.params.files[0])instanceof Array||((h=[])[0]=s.params.files[0]),s.viewer.loadImage(h,!1,!1,!1)):s.viewer.finishedLoading(),s.resizeViewerComponents(!1),s.nestedViewer||(e.parent().height("100%"),e.parent().width("100%")),n[d]=s,a.Container.showLicense(s,t))},a.Container.prototype.rebuildContainer=function(e,t){this.containerHtml.empty(),a.Container.fillContainerHTML(this.containerHtml,!1,e,t),a.Container.buildContainer(this.containerHtml,e,t),1!==n.length||n[0].nestedViewer||($("html").addClass(PAPAYA_CONTAINER_FULLSCREEN),$("body").addClass(PAPAYA_CONTAINER_FULLSCREEN),a.Container.setToFullPage())},a.Container.buildAllContainers=function(){var e,t;(e=$("#"+PAPAYA_DEFAULT_CONTAINER_ID)).length>0?(a.Container.fillContainerHTML(e,!0),t=a.Container.findParameters(e),a.Container.buildContainer(e,t)):$("."+PAPAYA_CONTAINER_CLASS_NAME).each((function(){null===(t=a.Container.findParameters($(this)))&&(t=[]),!0===t.fullScreen&&(t.fullScreenPadding=!1,t.kioskMode=!0,t.showControlBar=!1,$("body").css({"background-color":"black"})),a.Container.fillContainerHTML($(this),!1,t),a.Container.buildContainer($(this),t)})),1!==n.length||n[0].nestedViewer||($("html").addClass(PAPAYA_CONTAINER_FULLSCREEN),$("body").addClass(PAPAYA_CONTAINER_FULLSCREEN),a.Container.setToFullPage(),n[0].resizeViewerComponents(!0))},a.Container.startPapaya=function(){setTimeout((function(){window.scrollTo(0,0)}),0),a.Container.DICOM_SUPPORT="undefined"!=typeof daikon,a.Container.buildAllContainers()},a.Container.resizePapaya=function(e,t){var i;if(a.Container.updateOrthogonalState(),1!==n.length||n[0].nestedViewer)for(i=0;i<n.length;i+=1)n[i].resizeViewerComponents(!0);else a.utilities.PlatformUtils.smallScreen&&!t||n[0].resizeViewerComponents(!0);setTimeout((function(){window.scrollTo(0,0)}),0)},a.Container.addViewer=function(e,t,i){var n,s;s=$("#"+e),n=$('<div class="papaya"></div>'),s.html(n),s[0].onclick="",s.off("click"),a.Container.fillContainerHTML(n,!1,t),a.Container.buildContainer(n,t),i&&i()},a.Container.removeCheckForJSClasses=function(e,t){t.removeClass(PAPAYA_CONTAINER_CLASS_NAME),t.removeClass(PAPAYA_UTILS_CHECKFORJS_CSS),e.removeClass(PAPAYA_CONTAINER_CLASS_NAME),e.removeClass(PAPAYA_UTILS_CHECKFORJS_CSS)},a.Container.setToFullPage=function(){document.body.style.marginTop=0,document.body.style.marginBottom=0,document.body.style.marginLeft="auto",document.body.style.marginRight="auto",document.body.style.padding=0,document.body.style.overflow="hidden",document.body.style.width="100%",document.body.style.height="100%"},a.Container.getLicense=function(){return a.Container.LICENSE_TEXT},a.Container.getKeyboardReference=function(){return a.Container.KEYBOARD_REF_TEXT},a.Container.getMouseReference=function(){return a.Container.MOUSE_REF_TEXT},a.Container.setLicenseRead=function(){a.utilities.UrlUtils.createCookie(a.viewer.Preferences.COOKIE_PREFIX+"eula","Yes",a.viewer.Preferences.COOKIE_EXPIRY_DAYS)},a.Container.isLicenseRead=function(){var e=a.utilities.UrlUtils.readCookie(a.viewer.Preferences.COOKIE_PREFIX+"eula");return e&&"Yes"===e},a.Container.showLicense=function(e,t){t&&void 0!==t.showEULA&&t.showEULA&&!a.Container.isLicenseRead()&&new a.ui.Dialog(e,"License",a.ui.Toolbar.LICENSE_DATA,a.Container,null,a.Container.setLicenseRead,null,!0).showDialog()},a.Container.updateOrthogonalState=function(){var e;for(e=0;e<n.length;e+=1)n[e].orthogonal&&(a.utilities.PlatformUtils.mobile||n[e].orthogonalDynamic)&&($(window).height()>$(window).width()?n[e].orthogonalTall=!0:n[e].orthogonalTall=!1)},a.Container.reorientPapaya=function(){var e;for(e=0;e<n.length;e+=1)n[e].toolbar.closeAllMenus();a.Container.updateOrthogonalState(),a.Container.resizePapaya(null,!0)},a.Container.prototype.resetComponents=function(){this.containerHtml.css({height:"auto"}),this.containerHtml.css({width:"auto"}),this.containerHtml.css({margin:"auto"}),$("head").append("<style>div#papayaViewer:before{ content:'' }</style>")},a.Container.prototype.hasSurface=function(){return this.viewer&&this.viewer.surfaces.length>0},a.Container.prototype.getViewerDimensions=function(){var e,t,i,n,s,o;return e=this.containerHtml.parent().width()-(this.fullScreenPadding?2*PAPAYA_PADDING:0),n=this.orthogonal?this.hasSurface()?1.333:1.5:1,this.orthogonalTall||!this.orthogonal?(t=(this.collapsable?window.innerHeight:this.containerHtml.parent().height())-(a.viewer.Display.SIZE+(this.kioskMode?0:a.ui.Toolbar.SIZE+PAPAYA_SPACING)+PAPAYA_SPACING+(this.fullScreenPadding&&!this.nestedViewer?2*PAPAYA_CONTAINER_PADDING_TOP:0))-(this.showControlBar?2*a.ui.Toolbar.SIZE:0),i=papayaRoundFast(t/n)):(i=e,t=papayaRoundFast(i/n)),this.nestedViewer&&!this.collapsable||(this.orthogonalTall?i>(o=window.innerWidth-(this.fullScreenPadding?2*PAPAYA_PADDING:0))&&(i=o,t=papayaRoundFast(i*n)):t>(s=window.innerHeight-(a.viewer.Display.SIZE+(this.kioskMode?0:a.ui.Toolbar.SIZE+PAPAYA_SPACING)+PAPAYA_SPACING+(this.fullScreenPadding?2*PAPAYA_CONTAINER_PADDING_TOP:0))-(this.showControlBar?2*a.ui.Toolbar.SIZE:0))&&(t=s,i=papayaRoundFast(t*n))),[i,t]},a.Container.prototype.getViewerPadding=function(){return(this.containerHtml.parent().width()-(this.fullScreenPadding?2*PAPAYA_PADDING:0)-this.getViewerDimensions()[0])/2},a.Container.prototype.readGlobalParams=function(){this.kioskMode=!0===this.params.kioskMode||a.utilities.PlatformUtils.smallScreen,this.combineParametric=!0===this.params.combineParametric,this.params.loadingComplete&&(this.loadingComplete=this.params.loadingComplete),void 0!==this.params.showControls&&(this.showControls=this.params.showControls),void 0!==this.params.noNewFiles&&(this.noNewFiles=this.params.noNewFiles),void 0!==this.params.showImageButtons&&(this.showImageButtons=this.params.showImageButtons),a.utilities.PlatformUtils.smallScreen&&(this.showImageButtons=!1),void 0!==this.params.fullScreenPadding&&(this.fullScreenPadding=this.params.fullScreenPadding),void 0!==this.params.orthogonal&&(this.orthogonal=this.params.orthogonal),this.surfaceParams.showSurfacePlanes=!0===this.params.showSurfacePlanes,this.surfaceParams.showSurfaceCrosshairs=!0===this.params.showSurfaceCrosshairs,this.surfaceParams.surfaceBackground=this.params.surfaceBackground,this.orthogonalTall=this.orthogonal&&!0===this.params.orthogonalTall,this.orthogonalDynamic=this.orthogonal&&!0===this.params.orthogonalDynamic,void 0!==this.params.allowScroll&&(this.allowScroll=this.params.allowScroll),(a.utilities.PlatformUtils.mobile||this.orthogonalDynamic)&&this.orthogonal&&($(window).height()>$(window).width()?this.orthogonalTall=!0:this.orthogonalTall=!1),void 0!==this.params.syncOverlaySeries&&(this.syncOverlaySeries=this.params.syncOverlaySeries),void 0!==this.params.showControlBar&&(this.showControlBar=this.showControls&&this.params.showControlBar),void 0!==this.params.contextManager&&(this.contextManager=this.params.contextManager),!0===this.params.fullScreen&&(this.fullScreenPadding=this.params.fullScreenPadding=!1,this.kioskMode=this.params.kioskMode=!0,this.showControlBar=this.params.showControlBar=!1,$("body").css("background-color:'black'"))},a.Container.prototype.reset=function(){this.loadingImageIndex=0,this.loadingSurfaceIndex=0,this.nestedViewer=!1,this.collapsable=!1,this.orthogonal=!0,this.orthogonalTall=!1,this.orthogonalDynamic=!1,this.kioskMode=!1,this.noNewFiles=!1,this.showControls=!0,this.showControlBar=!1,this.fullScreenPadding=!0,this.combineParametric=!1,this.showRuler=!1},a.Container.prototype.resizeViewerComponents=function(e){var t,i,n=0;this.toolbar.closeAllMenus(),t=this.getViewerDimensions(),i=this.getViewerPadding(),this.toolbarHtml.css({width:t[0]+"px"}),this.toolbarHtml.css({height:a.ui.Toolbar.SIZE+"px"}),this.toolbarHtml.css({paddingLeft:i+"px"}),this.toolbarHtml.css({paddingBottom:PAPAYA_SPACING+"px"}),this.viewerHtml.css({width:t[0]+"px"}),this.viewerHtml.css({height:t[1]+"px"}),this.viewerHtml.css({paddingLeft:i+"px"}),e&&this.viewer.resizeViewer(t),this.displayHtml.css({height:a.viewer.Display.SIZE+"px"}),this.displayHtml.css({paddingLeft:i+"px"}),this.displayHtml.css({paddingTop:PAPAYA_SPACING+"px"}),this.display.canvas.width=t[0],this.showControls&&this.showControlBar?(this.sliderControlHtml.css({width:t[0]+"px"}),this.sliderControlHtml.css({height:a.viewer.Display.SIZE+"px"}),this.kioskMode?n+=0:n+=-50,this.viewer.hasSeries?n+=200:n+=0,t[0]<775+n?($("."+PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).css({display:"none"}),$("."+PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).css({display:"none"})):($("."+PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).css({display:"inline"}),$("."+PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).css({display:"inline"})),t[0]<600+n?($("."+PAPAYA_CONTROL_DIRECTION_SLIDER).css({display:"none"}),$("."+PAPAYA_CONTROL_MAIN_SLIDER).css({display:"inline"})):($("."+PAPAYA_CONTROL_DIRECTION_SLIDER).css({display:"inline"}),$("."+PAPAYA_CONTROL_MAIN_SLIDER).css({display:"none"})),this.viewer.hasSeries&&t[0]<450+n&&$("."+PAPAYA_CONTROL_MAIN_SLIDER).css({display:"none"}),t[0]<200?$("."+PAPAYA_CONTROL_SWAP_BUTTON_CSS).css({display:"none"}):$("."+PAPAYA_CONTROL_SWAP_BUTTON_CSS).css({display:"inline"}),this.viewer.hasSeries?$("."+PAPAYA_CONTROL_DIRECTION_SLIDER).eq(3).css({display:"inline"}):$("."+PAPAYA_CONTROL_DIRECTION_SLIDER).eq(3).css({display:"none"})):this.showControls&&this.viewer.initialized&&(t[0]<600?($("#"+PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS+this.containerIndex).css({display:"none"}),$("#"+PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS+this.containerIndex).css({display:"none"})):this.viewer.controlsHidden||($("#"+PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS+this.containerIndex).css({display:"inline"}),$("#"+PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS+this.containerIndex).css({display:"inline"}))),this.isDesktopMode()&&(t[0]<600?this.titlebarHtml.css({visibility:"hidden"}):this.titlebarHtml.css({visibility:"visible"})),this.nestedViewer&&!this.collapsable||!this.fullScreenPadding?this.containerHtml.css({paddingTop:"0"}):this.containerHtml.css({paddingTop:PAPAYA_CONTAINER_PADDING_TOP+"px"}),this.fullScreenPadding&&(this.containerHtml.css({paddingLeft:PAPAYA_PADDING+"px"}),this.containerHtml.css({paddingRight:PAPAYA_PADDING+"px"})),this.viewer.initialized?this.viewer.drawViewer(!1,!0):(this.viewer.drawEmptyViewer(),this.display.drawEmptyDisplay()),this.titlebarHtml.css({width:t[0]+"px",top:0})},a.Container.prototype.updateViewerSize=function(){this.toolbar.closeAllMenus(),this.viewer.resizeViewer(this.getViewerDimensions()),this.viewer.updateOffsetRect()},a.Container.prototype.buildViewer=function(e){var t;this.viewerHtml=this.containerHtml.find("."+PAPAYA_VIEWER_CSS),a.Container.removeCheckForJSClasses(this.containerHtml,this.viewerHtml),this.viewerHtml.html(""),t=this.getViewerDimensions(),this.viewer=new a.viewer.Viewer(this,t[0],t[1],e),this.viewerHtml.append($(this.viewer.canvas)),this.preferences.viewer=this.viewer},a.Container.prototype.buildDisplay=function(){var e;this.displayHtml=this.containerHtml.find("."+PAPAYA_DISPLAY_CSS),e=this.getViewerDimensions(),this.display=new a.viewer.Display(this,e[0]),this.displayHtml.append($(this.display.canvas))},a.Container.prototype.buildSliderControl=function(){this.sliderControlHtml=this.containerHtml.find("."+PAPAYA_KIOSK_CONTROLS_CSS)},a.Container.prototype.buildToolbar=function(){this.toolbarHtml=this.containerHtml.find("."+PAPAYA_TOOLBAR_CSS),this.toolbar=new a.ui.Toolbar(this),this.toolbar.buildToolbar(),this.toolbar.updateImageButtons()},a.Container.prototype.readFile=function(e,t){e.file(function(e,t){e&&"."!==t.name.charAt(0)&&e(t)}.bind(this,t))},a.Container.prototype.readDir=function(e){this.readDirNextEntries(e.createReader())},a.Container.prototype.readDirNextEntries=function(e){var t=this;e.readEntries((function(i){var n,s,o=i.length;if(o>0){for(n=0;n<o;n+=1)(s=i[n]).isFile&&t.readFile(s,a.utilities.ObjectUtils.bind(t,t.addDroppedFile));t.readDirNextEntries(e)}}))},a.Container.prototype.setUpDnD=function(){var e=this;this.containerHtml[0].ondragover=function(){return e.viewer.draggingOver=!0,e.viewer.initialized||e.viewer.drawEmptyViewer(),!1},this.containerHtml[0].ondragleave=function(){return e.viewer.draggingOver=!1,e.viewer.initialized||e.viewer.drawEmptyViewer(),!1},this.containerHtml[0].ondragend=function(){return e.viewer.draggingOver=!1,e.viewer.initialized||e.viewer.drawEmptyViewer(),!1},this.containerHtml[0].ondrop=function(t){t.preventDefault();var i=t.dataTransfer;if(e.display.drawProgress(.1,"Loading"),i)if(i.items&&i.items.length>0){var n,s,o=i.items,r=o.length;for(n=0;n<r;n+=1)(s=o[n]).getAsEntry?s=s.getAsEntry():s.webkitGetAsEntry&&(s=s.webkitGetAsEntry()),s.isFile?e.readFile(s,a.utilities.ObjectUtils.bind(e,e.addDroppedFile)):s.isDirectory&&e.readDir(s)}else i.files&&i.files.length>0&&e.viewer.loadImage(t.dataTransfer.files);return!1}},a.Container.prototype.addDroppedFile=function(e){clearTimeout(this.dropTimeout),o.push(e),this.dropTimeout=setTimeout(a.utilities.ObjectUtils.bind(this,this.droppedFilesFinishedLoading),100)},a.Container.prototype.droppedFilesFinishedLoading=function(){a.surface.Surface.findSurfaceType(o[0].name)!==a.surface.Surface.SURFACE_TYPE_UNKNOWN?this.viewer.loadSurface(o):this.viewer.loadImage(o),o=[]},a.Container.prototype.clearParams=function(){this.params=[]},a.Container.prototype.loadNext=function(){this.hasImageToLoad()?this.loadNextImage():this.hasSurfaceToLoad()?this.loadNextSurface():this.hasAtlasToLoad()&&this.viewer.loadAtlas()},a.Container.prototype.hasMoreToLoad=function(){return this.hasImageToLoad()||this.hasSurfaceToLoad()||this.hasAtlasToLoad()},a.Container.prototype.hasImageToLoad=function(){return this.params.images?this.loadingImageIndex<this.params.images.length:this.params.binaryImages?this.loadingImageIndex<this.params.binaryImages.length:this.params.encodedImages?this.loadingImageIndex<this.params.encodedImages.length:!!this.params.files&&this.loadingImageIndex<this.params.files.length},a.Container.prototype.hasAtlasToLoad=function(){return null==a.Container.atlas&&this.viewer.hasDefinedAtlas()},a.Container.prototype.hasSurfaceToLoad=function(){return a.utilities.PlatformUtils.isWebGLSupported()?this.params.surfaces?this.loadingSurfaceIndex<this.params.surfaces.length:!!this.params.encodedSurfaces&&this.loadingSurfaceIndex<this.params.encodedSurfaces.length:(console.log("Warning: This browser version is not able to load surfaces."),!1)},a.Container.prototype.loadNextSurface=function(){var e,t=!1;return this.params.surfaces?this.loadingSurfaceIndex<this.params.surfaces.length?(t=!0,e=this.params.surfaces[this.loadingSurfaceIndex],this.loadingSurfaceIndex+=1,this.viewer.loadSurface(e,!0,!1)):(this.params.loadedSurfaces=this.params.surfaces,this.params.surfaces=[]):this.params.encodedSurfaces&&(this.loadingSurfaceIndex<this.params.encodedSurfaces.length?(t=!0,(e=this.params.encodedSurfaces[this.loadingSurfaceIndex])instanceof Array||((e=[])[0]=this.params.encodedSurfaces[this.loadingSurfaceIndex]),this.viewer.loadSurface(e,!1,!0),this.loadingSurfaceIndex+=1):(this.params.loadedEncodedSurfaces=this.params.encodedSurfaces,this.params.encodedSurfaces=[])),t},a.Container.prototype.loadNextImage=function(){var e,t=!1;return this.params.images?this.loadingImageIndex<this.params.images.length?(t=!0,(e=this.params.images[this.loadingImageIndex])instanceof Array||((e=[])[0]=this.params.images[this.loadingImageIndex]),this.viewer.loadImage(e,!0,!1,!1),this.loadingImageIndex+=1):(this.params.loadedImages=this.params.images,this.params.images=[]):this.params.binaryImages?this.loadingImageIndex<this.params.binaryImages.length?(t=!0,(e=this.params.binaryImages[this.loadingImageIndex])instanceof Array||((e=[])[0]=this.params.binaryImages[this.loadingImageIndex]),this.viewer.loadImage(e,!1,!1,!0),this.loadingImageIndex+=1):(this.params.loadedEncodedImages=this.params.binaryImages,this.params.binaryImages=[]):this.params.encodedImages?this.loadingImageIndex<this.params.encodedImages.length?(t=!0,(e=this.params.encodedImages[this.loadingImageIndex])instanceof Array||((e=[])[0]=this.params.encodedImages[this.loadingImageIndex]),this.viewer.loadImage(e,!1,!0,!1),this.loadingImageIndex+=1):(this.params.loadedEncodedImages=this.params.encodedImages,this.params.encodedImages=[]):this.params.files&&(this.loadingImageIndex<this.params.files.length?(t=!0,(e=this.params.files[this.loadingImageIndex])instanceof Array||((e=[])[0]=this.params.files[this.loadingImageIndex]),this.viewer.loadImage(e,!1,!1,!1),this.loadingImageIndex+=1):(this.params.loadedFiles=this.params.files,this.params.files=[])),t},a.Container.prototype.readyForDnD=function(){return!this.kioskMode&&(void 0===this.params.images||this.loadingImageIndex>=this.params.images.length)&&(void 0===this.params.binaryImages||this.loadingImageIndex>=this.params.binaryImages.length)&&(void 0===this.params.encodedImages||this.loadingImageIndex>=this.params.encodedImages.length)&&(void 0===this.params.encodedSurfaces||this.loadingSurfaceIndex>=this.params.encodedSurfaces.length)},a.Container.prototype.findLoadableImage=function(e,t){var i;for(i=0;i<s.length;i+=1)if(t){if(s[i].surface&&s[i].name==e)return s[i]}else if(s[i].name==e)return s[i];return void 0!==window[e]?{encode:e}:null},a.Container.prototype.findLoadableImages=function(e,t){var i,a,n=[];if(Array.isArray(e)||(e=[e]),e)for(i=0;i<e.length;i++)(a=this.findLoadableImage(e[i],t))&&n.push(a);return n.length>0?n:null},a.Container.prototype.expandViewer=function(){var e=this;this.nestedViewer&&(this.nestedViewer=!1,this.collapsable=!0,this.tempScrollTop=$(window).scrollTop(),$(":hidden").addClass(PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT),$(document.body).children().hide(),this.containerHtml.show(),this.originalStyle={},this.originalStyle.width=document.body.style.width,this.originalStyle.height=document.body.style.height,this.originalStyle.marginTop=document.body.style.marginTop,this.originalStyle.marginRight=document.body.style.marginRight,this.originalStyle.marginBottom=document.body.style.marginBottom,this.originalStyle.marginLeft=document.body.style.marginLeft,this.originalStyle.paddingTop=document.body.style.paddingTop,this.originalStyle.paddingRight=document.body.style.paddingRight,this.originalStyle.paddingBottom=document.body.style.paddingBottom,this.originalStyle.paddingLeft=document.body.style.paddingLeft,this.originalStyle.overflow=document.body.style.overflow,a.Container.setToFullPage(),this.containerHtml.after('<div style="display:none" class="'+PAPAYA_CONTAINER_COLLAPSABLE+'"></div>'),$(document.body).prepend(this.containerHtml),this.resizeViewerComponents(!0),this.viewer.updateOffsetRect(),this.updateViewerSize(),setTimeout((function(){window.scrollTo(0,0),e.viewer.addScroll()}),0))},a.Container.prototype.collapseViewer=function(){var e,t;if(t=this,this.collapsable){for(this.nestedViewer=!0,this.collapsable=!1,document.body.style.width=this.originalStyle.width,document.body.style.height=this.originalStyle.height,document.body.style.marginTop=this.originalStyle.marginTop,document.body.style.marginRight=this.originalStyle.marginRight,document.body.style.marginBottom=this.originalStyle.marginBottom,document.body.style.marginLeft=this.originalStyle.marginLeft,document.body.style.paddingTop=this.originalStyle.paddingTop,document.body.style.paddingRight=this.originalStyle.paddingRight,document.body.style.paddingBottom=this.originalStyle.paddingBottom,document.body.style.paddingLeft=this.originalStyle.paddingLeft,document.body.style.overflow=this.originalStyle.overflow,$("."+PAPAYA_CONTAINER_COLLAPSABLE).replaceWith(this.containerHtml),$(document.body).children(":not(."+PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT+")").show(),$("."+PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT).removeClass(PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT),this.resizeViewerComponents(!0),e=0;e<n.length;e+=1)n[e].updateViewerSize(),n[e].viewer.drawViewer(!0);setTimeout((function(){$(window).scrollTop(t.tempScrollTop),t.viewer.removeScroll()}),0)}},a.Container.prototype.isNestedViewer=function(){return this.nestedViewer||this.collapsable},a.Container.prototype.isDesktopMode=function(){return!this.kioskMode},a.Container.prototype.hasLoadedDTI=function(){return this.viewer.hasLoadedDTI()},a.Container.prototype.disableScrollWheel=function(){return this.isNestedViewer()||a.utilities.PlatformUtils.ios},a.Container.prototype.canOpenInMango=function(){return this.params.canOpenInMango},a.Container.prototype.isExpandable=function(){return this.params.expandable&&this.isNestedViewer()},a.Container.prototype.isParametricCombined=function(e){return this.combineParametric&&this.viewer.hasParametricPair(e)},a.Container.prototype.isNonParametricCombined=function(e){return!this.isParametricCombined(e)},a.Container.prototype.coordinateChanged=function(e){var t,i,s=e.currentCoord;if(!e.ignoreSync)if(a.Container.syncViewersWorld)for(t=0;t<n.length;t+=1)n[t].viewer===e||n[t].viewer.ignoreSync||(i=new a.core.Coordinate,n[t].viewer.gotoWorldCoordinate(e.getWorldCoordinateAtIndex(s.x,s.y,s.z,i),!0));else if(a.Container.syncViewers)for(t=0;t<n.length;t+=1)n[t].viewer===e||n[t].viewer.ignoreSync||n[t].viewer.gotoCoordinate(s,!0);e.surfaceView&&e.surfaceView.updateActivePlanes(),this.contextManager&&this.contextManager.clearContext&&this.contextManager.clearContext()},a.Container.prototype.canCurrentOverlayLoadNegatives=function(){var e=this.viewer.currentScreenVolume;return!e.negative&&null===e.negativeScreenVol},a.Container.prototype.canCurrentOverlayLoadMod=function(){var e=this.viewer.currentScreenVolume;return e.dti&&null===e.dtiVolumeMod},a.Container.prototype.canCurrentOverlayModulate=function(){var e=this.viewer.currentScreenVolume;return e.dti&&null!==e.dtiVolumeMod},window.addEventListener("resize",a.Container.resizePapaya,!1),window.addEventListener("orientationchange",a.Container.reorientPapaya,!1),window.addEventListener("load",a.Container.startPapaya,!1),window.addEventListener("message",(function(e){e.data===PAPAYA_MANGO_INSTALLED&&(a.mangoinstalled=!0)}),!1)}]);